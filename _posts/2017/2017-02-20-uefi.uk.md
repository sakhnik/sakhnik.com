---
layout: post
title:  "Завантаження лаптопа у режимі UEFI"
ref:    2017-02-20-uefi
lang:   uk
date:   2017-02-20 23:37:50 +02:00
tags:   linux
---

Щойно купив новенький лаптоп HP Notebook 15 і витратив годину на встановлення
Arch linux. Сучасний комп’ютер наполягає на UEFI ще більш наполегливо. Тож
треба було спробувати. Проте виявилося, що це легко під час нового встановлення.

Ось що я зробив:

1. Створив таблицю розділів GPT замість MBR
2. Виділив розділ для EFI: [сторінка wiki](https://wiki.archlinux.org/index.php/EFI_System_Partition)
3. Забезпечив його монтування у `/boot`
4. Встановив [`systemd-boot`](https://wiki.archlinux.org/index.php/systemd-boot) з допомогою `bootctl install`
5. Сконфігурував [завантажувач](https://wiki.archlinux.org/index.php/Systemd-boot#Standard_root_installations)
	arch.

Спрацювало з першого разу на новому приладі. Але потім з’явилася спокуса
перевести мій Xiaomi mi notebook air з старого завантаження MBR/grub до UEFI.
В ідеалі без втрати даних чи потреби перевстановити систему. Це теж легко
вдалося. На щастя, у мене був розділ обміну пам’яті 8 ГБ на початку сховища.

Ось мої кроки:

1. Зберіг таблицю розділів для зразка
2. Створив нову таблицю розділів GPT
3. Створив розділ даних з тим самим початком/кінцем, що й був раніше
4. Створив розділ EFI 512 МБ на початку сховища
5. Створив розділ обміну на решту 7.5 ГБ
6. Поправив файлові системи, `/etc/fstab`
7. Перейшов до встановлення `systemd-boot`
8. Нарешті, прибрав із системи grub.

Здається, такий налаштунок сучасніший і крутіший.

```
$ sudo parted /dev/sda print
[sudo] пароль до sakhnik:
Модель: ATA SAMSUNG MZNTY128 (scsi)
Диск /dev/sda: 128GB
Розмір сектора (логічний/фізичний): 512Б/512Б
таблиця розділів: gpt
Прапорці диска:

Номер  Початок  Кінець  Розмір  Файлова система  Назва  Ознаки
 2     1049kB   538MB   537MB   fat32                   boot, esp
 3     538MB    8591MB  8053MB  linux-swap(v1)
 1     8591MB   128GB   119GB   ext4
```
